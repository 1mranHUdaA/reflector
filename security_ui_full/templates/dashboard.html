<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Security Tool Dashboard</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<div class="layout">

  <aside class="sidebar">
    <h1>Security Tool<br>Dashboard</h1>

    <div class="box">
      <h3>New Scan</h3>
      <form action="/scan" method="post" enctype="multipart/form-data" class="scan-form">
        <label>Single domain</label>
        <input type="text" name="domain" placeholder="example.com">

        <label>Bulk domains (.txt)</label>
        <input type="file" name="file">

        <button type="submit">Run Scan</button>
      </form>
    </div>

    <div class="box">
      <h3>Filters</h3>
      <form action="/" method="get" class="filter-form">
        <input type="text" name="q" value="{{ q }}" placeholder="search domain">
        <select name="status">
          <option value="">All status</option>
          <option value="pending" {% if status=='pending' %}selected{% endif %}>pending</option>
          <option value="running" {% if status=='running' %}selected{% endif %}>running</option>
          <option value="done" {% if status=='done' %}selected{% endif %}>done</option>
          <option value="error" {% if status=='error' %}selected{% endif %}>error</option>
        </select>
        <button type="submit">Apply</button>
      </form>
    </div>

    <div class="box subtle">
      <h3>Legend</h3>
      <ul class="legend">
        <li><span class="dot pending"></span> pending</li>
        <li><span class="dot running"></span> running</li>
        <li><span class="dot done"></span> done</li>
        <li><span class="dot error"></span> error</li>
      </ul>
    </div>
  </aside>

  <main class="main">
    <h2>Scan History</h2>
    <p class="hint">Bulk or single domains are processed through clean.sh → parameter.sh → hidden.py → xsslection.py pipeline.</p>

    <table class="results">
      <thead>
      <tr>
        <th>ID</th>
        <th>Domain</th>
        <th>Parameters</th>
        <th>Hidden Params</th>
        <th>Status</th>
        <th>Created</th>
        <th>Details</th>
      </tr>
      </thead>
      <tbody>
      {% for s in scans %}
        <tr>
          <td>{{ s.id }}</td>
          <td>{{ s.domain }}</td>
          <td title="{{ s.parameters or '' }}">
            {{ (s.parameters or '')[:40] }}{% if s.parameters and s.parameters|length > 40 %}…{% endif %}
          </td>
          <td title="{{ s.hidden_params or '' }}">
            {{ (s.hidden_params or '')[:40] }}{% if s.hidden_params and s.hidden_params|length > 40 %}…{% endif %}
          </td>
          <td class="status {{ s.status }}">{{ s.status }}</td>
          <td>{{ s.created_at }}</td>
          <td><a href="/detail/{{ s.id }}">view</a></td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </main>

</div>
<script src="/static/app.js"></script>
</body>
</html>
